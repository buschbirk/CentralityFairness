Running on desktop3:
21/02/21 16:51:15 WARN Utils: Your hostname, desktop3 resolves to a loopback address: 127.0.0.1; using 172.16.16.103 instead (on interface eno1)
21/02/21 16:51:15 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
21/02/21 16:51:16 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Traceback (most recent call last):
  File "/home/laal/MAG/CentralityFairness/MAG_attributes.py", line 190, in <module>
    citations = citation_edges(mag)
  File "/home/laal/MAG/CentralityFairness/MAG_attributes.py", line 148, in citation_edges
    citations = mag.query_sql(query)
  File "/home/laal/MAG/CentralityFairness/MAG.py", line 56, in query_sql
    df = self.spark.sql(query)
  File "/home/laal/.conda/envs/torchenv/lib/python3.7/site-packages/pyspark/sql/session.py", line 649, in sql
    return DataFrame(self._jsparkSession.sql(sqlQuery), self._wrapped)
  File "/home/laal/.conda/envs/torchenv/lib/python3.7/site-packages/py4j/java_gateway.py", line 1305, in __call__
    answer, self.gateway_client, self.target_id, self.name)
  File "/home/laal/.conda/envs/torchenv/lib/python3.7/site-packages/pyspark/sql/utils.py", line 134, in deco
    raise_from(converted)
  File "<string>", line 3, in raise_from
pyspark.sql.utils.AnalysisException: Table or view not found: Paper; line 16 pos 15;
'Project ['paa1.AuthorId AS CitingAuthorId#80, 'pr.PaperId AS CitingPaperId#81, 'p1.Date AS CitingPaperDate#82, 'prf1.AncestorId AS CitingPaperFieldOfStudy#83, 'paa2.AuthorId AS CitedAuthorId#84, 'pr.PaperReferenceId AS CitedPaperId#85, 'p2.date AS CitedPaperDate#86, 'prf2.AncestorId AS CitedPaperFieldOfStudy#87]
+- 'Filter (('prf1.fieldRank = 1) AND ('prf2.fieldRank = 1))
   +- 'Join Inner, ('paa2.AuthorId = 'wtm.MAG)
      :- 'Join Inner, ('paa1.AuthorId = 'wtm.MAG)
      :  :- 'Join Inner, ('p2.PaperId = 'pr.PaperReferenceId)
      :  :  :- 'Join Inner, ('paa1.PaperId = 'p1.PaperId)
      :  :  :  :- Join Inner, (PaperId#88L = PaperReferenceId#19L)
      :  :  :  :  :- Join Inner, (PaperId#0L = PaperId#22L)
      :  :  :  :  :  :- Join Inner, (PaperReferenceId#19L = PaperId#88L)
      :  :  :  :  :  :  :- Join Inner, (PaperId#0L = PaperId#18L)
      :  :  :  :  :  :  :  :- SubqueryAlias paa1
      :  :  :  :  :  :  :  :  +- SubqueryAlias paperauthoraffiliations
      :  :  :  :  :  :  :  :     +- Relation[PaperId#0L,AuthorId#1L,AffiliationId#2L,AuthorSequenceNumber#3,OriginalAuthor#4,OriginalAffiliation#5] csv
      :  :  :  :  :  :  :  +- SubqueryAlias pr
      :  :  :  :  :  :  :     +- SubqueryAlias paperreferences
      :  :  :  :  :  :  :        +- Relation[PaperId#18L,PaperReferenceId#19L] csv
      :  :  :  :  :  :  +- SubqueryAlias paa2
      :  :  :  :  :  :     +- SubqueryAlias paperauthoraffiliations
      :  :  :  :  :  :        +- Relation[PaperId#88L,AuthorId#89L,AffiliationId#90L,AuthorSequenceNumber#91,OriginalAuthor#92,OriginalAffiliation#93] csv
      :  :  :  :  :  +- SubqueryAlias prf1
      :  :  :  :  :     +- SubqueryAlias paperrootfield
      :  :  :  :  :        +- Relation[PaperId#22L,AncestorId#23L,NumSubfieldsInField#24,fieldRank#25] csv
      :  :  :  :  +- SubqueryAlias prf2
      :  :  :  :     +- SubqueryAlias paperrootfield
      :  :  :  :        +- Relation[PaperId#94L,AncestorId#95L,NumSubfieldsInField#96,fieldRank#97] csv
      :  :  :  +- 'SubqueryAlias p1
      :  :  :     +- 'UnresolvedRelation [Paper]
      :  :  +- 'SubqueryAlias p2
      :  :     +- 'UnresolvedRelation [Paper]
      :  +- SubqueryAlias wtm1
      :     +- SubqueryAlias wostomag
      :        +- Relation[WOS#12L,MAG#13L,Gender#14] csv
      +- SubqueryAlias wtm2
         +- SubqueryAlias wostomag
            +- Relation[WOS#12L,MAG#13L,Gender#14] csv

